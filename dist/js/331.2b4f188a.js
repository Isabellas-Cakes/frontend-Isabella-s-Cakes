"use strict";(self["webpackChunkinterfaz"]=self["webpackChunkinterfaz"]||[]).push([[331],{1882:function(e,a,t){t.r(a),t.d(a,{default:function(){return Y}});t(4114),t(8111),t(116),t(1701),t(3579);var n=t(6768),o=t(4232),r=t(144),s=t(1387),l=t(4373),i=t(1714),u=t(5130),c=t(365),d=t(5043),m=t(7579),v=t(3627),p=t(4119),f=t(2046),b=t(1773),_=t(329),g=t(6548),k=t(2225),h=t(5937),y=t(8392),S=t(4396),w=t(5081),C=t(7443);const x=(0,y.j)({bordered:Boolean,color:String,content:[Number,String],dot:Boolean,floating:Boolean,icon:p.TX,inline:Boolean,label:{type:String,default:"$vuetify.badge"},max:[Number,String],modelValue:{type:Boolean,default:!0},offsetX:[Number,String],offsetY:[Number,String],textColor:String,...(0,m.u)(),...(0,b.M)({location:"top end"}),...(0,_.S)(),...(0,g.X)(),...(0,k.yx)(),...(0,h.m)({transition:"scale-rotate-transition"}),...(0,v.X)()},"VBadge"),F=(0,S.RW)()({name:"VBadge",inheritAttrs:!1,props:x(),setup(e,a){const{backgroundColorClasses:t,backgroundColorStyles:o}=(0,d.z6)(()=>e.color),{roundedClasses:r}=(0,_.v)(e),{t:s}=(0,f.Ym)(),{textColorClasses:l,textColorStyles:i}=(0,d.aH)(()=>e.textColor),{themeClasses:m}=(0,k.DP)(),{locationStyles:p}=(0,b.z)(e,!0,a=>{const t=e.floating?e.dot?2:4:e.dot?8:12;return t+(["top","bottom"].includes(a)?Number(e.offsetY??0):["left","right"].includes(a)?Number(e.offsetX??0):0)}),{dimensionStyles:g}=(0,v.S)(e);return(0,w.C)(()=>{const d=Number(e.content),v=!e.max||isNaN(d)?e.content:d<=Number(e.max)?d:`${e.max}+`,[f,b]=(0,C.Ai)(a.attrs,["aria-atomic","aria-label","aria-live","role","title"]);return(0,n.bF)(e.tag,(0,n.v6)({class:["v-badge",{"v-badge--bordered":e.bordered,"v-badge--dot":e.dot,"v-badge--floating":e.floating,"v-badge--inline":e.inline},e.class]},b,{style:e.style}),{default:()=>[(0,n.Lk)("div",{class:"v-badge__wrapper"},[a.slots.default?.(),(0,n.bF)(h.M,{transition:e.transition},{default:()=>[(0,n.bo)((0,n.Lk)("span",(0,n.v6)({class:["v-badge__badge",m.value,t.value,r.value,l.value],style:[o.value,i.value,g.value,e.inline?{}:p.value],"aria-atomic":"true","aria-label":s(e.label,d),"aria-live":"polite",role:"status"},f),[e.dot?void 0:a.slots.badge?a.slots.badge?.():e.icon?(0,n.bF)(c.w,{icon:e.icon},null):v]),[[u.aG,e.modelValue]])]})])]})}),{}}});var W=t(4789),L=t(222),I=t(5939),N=t(3495),$=t(5526),B=t(6838),M=t(4629),V=t(1539),K=t(9293),X=t(8741),D=t(8210),P=t(2034),R=t(9416);const T={class:"text-subtitle-1 font-weight-medium"},A={key:1,class:"text-caption mt-1"},E="mesaEstados";var z={__name:"PedidosActivos",setup(e){const a=(0,i.io)("http://localhost:8080"),t=(0,s.rd)(),u=(0,r.KR)([]),d=(0,r.KR)(localStorage.getItem("rol")),m=(0,r.KR)([]),v=(0,r.KR)(!1),p=(0,r.KR)(""),f=(0,r.KR)("green");function b(e,a="green"){p.value=e,f.value=a,v.value=!0}const _=new Audio("/sounds/notify.mp3");document.addEventListener("click",()=>{_.play().then(()=>{_.pause(),_.currentTime=0}).catch(()=>{})},{once:!0});const g=()=>{_.currentTime=0,_.play().catch(()=>{})};function k(){try{return JSON.parse(localStorage.getItem(E))||{}}catch{return{}}}function h(e,a){const t=k();t[e]=a,localStorage.setItem(E,JSON.stringify(t))}function y(e){const a=k();delete a[e],localStorage.setItem(E,JSON.stringify(a))}const S=(0,n.EW)(()=>{const e={};for(const a of m.value)e[a.id_mesa]=(e[a.id_mesa]||0)+1;return e});function w(e){const a=(e||"").toLowerCase().trim();return"ocupado"===a||"ocupada"===a?"ocupada":"pendiente"===a?"pendiente":"servido"===a||"pendiente de pago"===a?"pendiente de pago":a}function C(e){switch(w(e)){case"ocupada":return"Ocupado";case"reservada":return"Reservada";case"pendiente":return"Pendiente";case"en preparación":return"En preparación";case"listo":return"Listo";case"pendiente de pago":return"Pendiente de pago";default:return"Libre"}}function x(e){switch(w(e)){case"ocupada":return"mdi-account-group";case"reservada":return"mdi-bookmark";case"pendiente":return"mdi-timer-sand";case"en preparación":return"mdi-fire";case"listo":return"mdi-check-circle";case"pendiente de pago":return"mdi-cash-register";default:return"mdi-checkbox-blank-circle-outline"}}function z(e){switch(w(e)){case"ocupada":return"red";case"reservada":return"orange";case"pendiente":return"blue-grey";case"en preparación":return"orange";case"listo":return"green";case"pendiente de pago":return"purple";default:return"green"}}function J(e){const a=["mesa-card","rounded-lg"],t=w(e.estado);return"ocupada"===t?a.push("mesa-ocupada"):"reservada"===t?a.push("mesa-reservada"):"pendiente"===t?a.push("mesa-pendiente"):"en preparación"===t?a.push("mesa-prep"):"pendiente de pago"===t?a.push("mesa-pago"):a.push("mesa-libre"),S.value[e.id_mesa]&&a.push("pulse-border"),a}function O(){localStorage.clear(),window.location.href="/"}const Y=async()=>{try{const{data:e}=await l.A.get("http://localhost:8080/api/mesas"),a=k();u.value=e.map(e=>a[e.id_mesa]?{...e,estado:a[e.id_mesa]}:e)}catch(e){console.error("Error al cargar mesas:",e)}};function j(e){const t=m.value[e];t&&(a.emit("articulo-servido",{id_mesa:t.id_mesa,nombre_articulo:t.nombre,hora_servido:(new Date).toISOString()}),m.value.splice(e,1),b(`🍽️ "${t.nombre}" de mesa ${t.numeroMesa} servido.`,"green"))}function Q(){const e=[...m.value];m.value=[];for(const t of e)a.emit("articulo-servido",{id_mesa:t.id_mesa,nombre_articulo:t.nombre,hora_servido:(new Date).toISOString()});b(`✅ ${e.length} artículo(s) servidos.`,"green")}function G(e){const n=[],o=[];for(const a of m.value)a.id_mesa===e.id_mesa?o.push(a):n.push(a);m.value=n,o.length&&(o.forEach(e=>{a.emit("articulo-servido",{id_mesa:e.id_mesa,nombre_articulo:e.nombre,hora_servido:(new Date).toISOString()})}),b(`🍽️ ${o.length} artículo(s) de la mesa ${e.numero} servidos.`,"green")),t.push({name:"NuevoPedido",params:{mesaId:e.id_mesa}})}return(0,n.sV)(()=>{Y(),a.on("pedido-pagado",({id_mesa:e})=>{const a=u.value.find(a=>a.id_mesa===e);a&&(a.estado="libre"),y(e)}),a.on("estado-pedido-actualizado",e=>{const a=(e.estado||"").toLowerCase(),t=e.id_mesa;if(!["pendiente","en preparación","listo","servido","pendiente de pago","ocupado","ocupada","reservada"].includes(a))return;const n=u.value.find(e=>e.id_mesa===t);if(!n)return;const o=w(a),r=o;n.estado=r,h(t,r);const s="pendiente"===r?`⏳ Mesa ${n.numero}: pedido pendiente`:"en preparación"===r?`🔥 Mesa ${n.numero}: pedido en preparación`:"listo"===r?`✅ Mesa ${n.numero}: pedido LISTO`:"pendiente de pago"===r?`💳 Mesa ${n.numero}: pendiente de pago`:"ocupada"===r?`👥 Mesa ${n.numero}: ocupada`:`ℹ️ Mesa ${n.numero}: ${r}`,l="pendiente"===r?"blue-grey":"en preparación"===r?"orange":"listo"===r?"green":"pendiente de pago"===r?"purple":"ocupada"===r?"red":"grey";b(s,l),"listo"===r&&g()}),a.on("articulo-preparado",({nombre_articulo:e,id_mesa:a})=>{const t=u.value.find(e=>e.id_mesa===a),n=t?.numero||a,o=e,r=m.value.some(e=>e.nombre===o&&e.id_mesa===a);r||(m.value.push({nombre:o,id_mesa:a,numeroMesa:n,timestamp:new Date}),b(`✅ El artículo ${o} de la mesa ${n} está listo.`,"green"),g())})}),(0,n.hi)(()=>{a.off("pedido-pagado"),a.off("estado-pedido-actualizado"),a.off("articulo-preparado")}),(e,a)=>{const t=(0,n.g2)("v-list-item-content");return(0,n.uX)(),(0,n.Wv)(B.I,null,{default:(0,n.k6)(()=>[(0,n.bF)(M.L,{class:"align-center justify-space-between mb-4"},{default:(0,n.k6)(()=>[(0,n.bF)(V.B,{cols:"auto"},{default:(0,n.k6)(()=>a[2]||(a[2]=[(0,n.Lk)("h2",{class:"text-h5 font-weight-bold mb-0"},"📋 Selecciona una mesa",-1)])),_:1,__:[2]}),(0,n.bF)(V.B,{cols:"auto",class:"d-flex",style:{gap:"8px"}},{default:(0,n.k6)(()=>[(0,n.bF)(W.D,{color:"purple",variant:"tonal",onClick:a[0]||(a[0]=a=>e.$router.push({name:"PedidosFuera"}))},{default:(0,n.k6)(()=>[(0,n.bF)(c.w,{start:""},{default:(0,n.k6)(()=>a[3]||(a[3]=[(0,n.eW)("mdi-cake",-1)])),_:1,__:[3]}),a[4]||(a[4]=(0,n.eW)(" Pedidos externos ",-1))]),_:1,__:[4]}),"mesero"===d.value?((0,n.uX)(),(0,n.Wv)(W.D,{key:0,color:"black",variant:"outlined",onClick:O})):(0,n.Q3)("",!0),(0,n.bF)(W.D,{color:"black",variant:"outlined",onClick:O},{default:(0,n.k6)(()=>[(0,n.bF)(c.w,{left:""},{default:(0,n.k6)(()=>a[5]||(a[5]=[(0,n.eW)("mdi-logout",-1)])),_:1,__:[5]}),a[6]||(a[6]=(0,n.eW)(" Cerrar sesión ",-1))]),_:1,__:[6]})]),_:1})]),_:1}),(0,n.bF)(M.L,null,{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(u.value,e=>((0,n.uX)(),(0,n.Wv)(V.B,{key:e.id_mesa,cols:"6",sm:"4",md:"3"},{default:(0,n.k6)(()=>[(0,n.bF)(L.J,{class:(0,o.C4)([J(e),"pa-4 d-flex flex-column align-center justify-center relative"]),height:"120",onClick:a=>G(e)},{default:(0,n.k6)(()=>[S.value[e.id_mesa]?((0,n.uX)(),(0,n.Wv)(F,{key:0,content:S.value[e.id_mesa],color:"green",floating:"","offset-x":"-8","offset-y":"8"},null,8,["content"])):(0,n.Q3)("",!0),(0,n.bF)(c.w,{size:"32",class:"mb-2"},{default:(0,n.k6)(()=>a[7]||(a[7]=[(0,n.eW)("mdi-table-chair",-1)])),_:1,__:[7]}),(0,n.Lk)("div",T," Mesa "+(0,o.v_)(e.numero),1),(0,n.bF)(N.x,{size:"small",color:z(e.estado),variant:"flat",class:"mt-1"},{default:(0,n.k6)(()=>[(0,n.bF)(c.w,{start:"",size:"16"},{default:(0,n.k6)(()=>[(0,n.eW)((0,o.v_)(x(e.estado)),1)]),_:2},1024),(0,n.eW)(" "+(0,o.v_)(C(e.estado)),1)]),_:2},1032,["color"]),S.value[e.id_mesa]?((0,n.uX)(),(0,n.CE)("div",A,(0,o.v_)(S.value[e.id_mesa])+" listo(s) 🍽️ ",1)):(0,n.Q3)("",!0)]),_:2},1032,["class","onClick"])]),_:2},1024))),128))]),_:1}),m.value.length?((0,n.uX)(),(0,n.Wv)(L.J,{key:0,class:"mt-6"},{default:(0,n.k6)(()=>[(0,n.bF)(I.r,{class:"text-h6 d-flex align-center justify-space-between"},{default:(0,n.k6)(()=>[a[10]||(a[10]=(0,n.eW)(" 🍽️ Artículos listos para servir ",-1)),(0,n.bF)(W.D,{size:"small",color:"green",variant:"text",onClick:Q},{default:(0,n.k6)(()=>[(0,n.bF)(c.w,{start:""},{default:(0,n.k6)(()=>a[8]||(a[8]=[(0,n.eW)("mdi-check-all",-1)])),_:1,__:[8]}),a[9]||(a[9]=(0,n.eW)(" Servir todo ",-1))]),_:1,__:[9]})]),_:1,__:[10]}),(0,n.bF)($.G),(0,n.bF)(K.x8,null,{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(m.value,(e,r)=>((0,n.uX)(),(0,n.Wv)(X.g,{key:e.id_mesa+"-"+e.nombre+"-"+r,onClick:e=>j(r),class:"cursor-pointer"},{default:(0,n.k6)(()=>[(0,n.bF)(t,null,{default:(0,n.k6)(()=>[(0,n.bF)(D.U,null,{default:(0,n.k6)(()=>[(0,n.Lk)("strong",null,"Mesa "+(0,o.v_)(e.numeroMesa),1),a[11]||(a[11]=(0,n.eW)(" · ",-1)),(0,n.Lk)("strong",null,(0,o.v_)(e.nombre),1),a[12]||(a[12]=(0,n.eW)(" listo para servir ",-1))]),_:2,__:[11,12]},1024),(0,n.bF)(P.w,null,{default:(0,n.k6)(()=>[(0,n.eW)((0,o.v_)(new Date(e.timestamp).toLocaleTimeString()),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})):(0,n.Q3)("",!0),(0,n.bF)(R.K,{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=e=>v.value=e),timeout:"6000",color:f.value,location:"top"},{default:(0,n.k6)(()=>[(0,n.eW)((0,o.v_)(p.value),1)]),_:1},8,["modelValue","color"])]),_:1})}}},J=t(1241);const O=(0,J.A)(z,[["__scopeId","data-v-c7458224"]]);var Y=O},9416:function(e,a,t){t.d(a,{K:function(){return C}});t(8111),t(8237);var n=t(6768),o=t(6029),r=t(223),s=t(5282),l=t(9592),i=t(6315),u=t(1773),c=t(6729),d=t(8432),m=t(329),v=t(6349),p=t(2225),f=t(9948),b=t(6573),_=t(144),g=t(8392),k=t(7443),h=t(4396),y=t(5081);function S(e){const a=(0,_.IJ)(e());let t=-1;function o(){clearInterval(t)}function r(){o(),(0,n.dY)(()=>a.value=e())}function s(n){const r=n?getComputedStyle(n):{transitionDuration:.2},s=1e3*parseFloat(r.transitionDuration)||200;if(o(),a.value<=0)return;const l=performance.now();t=window.setInterval(()=>{const t=performance.now()-l+s;a.value=Math.max(e()-t,0),a.value<=0&&o()},s)}return(0,_.jr)(o),{clear:o,time:a,start:s,reset:r}}const w=(0,g.j)({multiLine:Boolean,text:String,timer:[Boolean,String],timeout:{type:[Number,String],default:5e3},vertical:Boolean,...(0,u.M)({location:"bottom"}),...(0,c.S)(),...(0,m.S)(),...(0,b.gI)(),...(0,p.yx)(),...(0,k.cJ)((0,r.D)({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),C=(0,h.RW)()({name:"VSnackbar",props:w(),emits:{"update:modelValue":e=>!0},setup(e,a){let{slots:t}=a;const u=(0,d.q)(e,"modelValue"),{positionClasses:g}=(0,c.J)(e),{scopeId:h}=(0,v.b)(),{themeClasses:w}=(0,p.NX)(e),{colorClasses:C,colorStyles:x,variantClasses:F}=(0,b.rn)(e),{roundedClasses:W}=(0,m.v)(e),L=S(()=>Number(e.timeout)),I=(0,_.KR)(),N=(0,_.KR)(),$=(0,_.IJ)(!1),B=(0,_.IJ)(0),M=(0,_.KR)(),V=(0,n.WQ)(l.aF,void 0);(0,f.Y)(()=>!!V,()=>{const e=(0,l.gK)();(0,n.nT)(()=>{M.value=e.mainStyles.value})}),(0,n.wB)(u,X),(0,n.wB)(()=>e.timeout,X),(0,n.sV)(()=>{u.value&&X()});let K=-1;function X(){L.reset(),window.clearTimeout(K);const a=Number(e.timeout);if(!u.value||-1===a)return;const t=(0,k._p)(N.value);L.start(t),K=window.setTimeout(()=>{u.value=!1},a)}function D(){L.reset(),window.clearTimeout(K)}function P(){$.value=!0,D()}function R(){$.value=!1,X()}function T(e){B.value=e.touches[0].clientY}function A(e){Math.abs(B.value-e.changedTouches[0].clientY)>50&&(u.value=!1)}function E(){$.value&&R()}const z=(0,n.EW)(()=>e.location.split(" ").reduce((e,a)=>(e[`v-snackbar--${a}`]=!0,e),{}));return(0,y.C)(()=>{const a=r.L.filterProps(e),l=!!(t.default||t.text||e.text);return(0,n.bF)(r.L,(0,n.v6)({ref:I,class:["v-snackbar",{"v-snackbar--active":u.value,"v-snackbar--multi-line":e.multiLine&&!e.vertical,"v-snackbar--timer":!!e.timer,"v-snackbar--vertical":e.vertical},z.value,g.value,e.class],style:[M.value,e.style]},a,{modelValue:u.value,"onUpdate:modelValue":e=>u.value=e,contentProps:(0,n.v6)({class:["v-snackbar__wrapper",w.value,C.value,W.value,F.value],style:[x.value],onPointerenter:P,onPointerleave:R},a.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0,onTouchstartPassive:T,onTouchend:A,onAfterLeave:E},h),{default:()=>[(0,b.wN)(!1,"v-snackbar"),e.timer&&!$.value&&(0,n.Lk)("div",{key:"timer",class:"v-snackbar__timer"},[(0,n.bF)(s.Z,{ref:N,color:"string"===typeof e.timer?e.timer:"info",max:e.timeout,"model-value":L.time.value},null)]),l&&(0,n.Lk)("div",{key:"content",class:"v-snackbar__content",role:"status","aria-live":"polite"},[t.text?.()??e.text,t.default?.()]),t.actions&&(0,n.bF)(o.K,{defaults:{VBtn:{variant:"text",ripple:!1,slim:!0}}},{default:()=>[(0,n.Lk)("div",{class:"v-snackbar__actions"},[t.actions({isActive:u})])]})],activator:t.activator})}),(0,i.O)({},I)}})}}]);
//# sourceMappingURL=331.2b4f188a.js.map